<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>
        <title>t-próba</title>
    </head>
    <body>
        <div style="display: flex; width: 90vw; margin-left: 5vw; margin-right: 5vw;">
            <div style="width: 60%;">
                <form style="display: flex; flex-direction: column; width: 90%; margin-left: 5%; margin-right: 5%; height: 80vh; justify-content: space-evenly;">
                    <h1>t-próba</h1>
                    <textarea placeholder="499;525;498;503;501;497;493;496;500;495" style="resize: none;" class="form-control" id="array" cols="30" rows="5"></textarea>
                    <input class="form-control" type="text" id="m" placeholder="H0">
                    <input type="submit" id="submit" value="Számítás" class="btn btn-primary">
                    <div style="width: 100%; margin-top: 2vh; display: flex; flex-direction: row;">    
                        <h3 style="margin-right: 40px;">t: </h3>
                        <h3 id="result"></h3>
                    </div>
                </form>
            </div>
            <div style="width: 40%;">
                <div class="jumbotron" style="margin-top: 5vh; width: 90%; margin-left: 5%;">
                    <p>Adja meg a tesztadatokat ";"-vel elválasztva úgy,  hogy az utolsó elem után már ne álljon pontos vessző!</p>
                    <p>pl: <b>499;525;498;503;501;497;493;496;500;495</b></p>
                    <p>Ezután adja meg a nullhipotézist (H0)!</p>
                    <p>Ezután kattintson a Számolás gombra, az eredmény a t: után lessz látható.</p>
                    <p class="alert alert-dismissible alert-danger">Amennyiben az NaN hibakód jelenik meg lehetséges, hogy hibás adatokat adott meg.</p>
                </div>
                <div>
                    <canvas id="myChart" width="400" height="400"></canvas>
                </div>
            </div>
        </div>
        <script>
            function tProbe(array, m) {

                Sn_2 = 0;
                n = array.length;
                Xj_2 = 0;
                Sum = 0;

                for (i = 0; i < n; i++) {
                    Xj_2 += Math.pow(parseFloat(array[i]), 2);
                    Sum += parseFloat(array[i]);
                };

                avg = (Sum/n);

                Sn_2 = (1/(n-1)) *(Xj_2 - n*Math.pow(avg, 2)) ;

                t = (((avg - m) / Math.sqrt(Sn_2)) * Math.sqrt(n)).toFixed(4);

                return t;
            };

            document.getElementById("submit").addEventListener('click', (event) => {
                event.preventDefault();
                
                array = document.getElementById("array");
                m = document.getElementById("m");

                if (array.value != '' || m.value != '' || sigma.value || '') {
                    if (actualArray = array.value.split(';')) {
                        
                        t = tProbe(actualArray, parseFloat(m.value));
                        document.getElementById("result").innerText = t;
                    };
                };
            });



            document.getElementById("array").addEventListener('change', function() {
                arrayText = document.getElementById("array").value;
                if (arrayText.substr(arrayText.length -1) == ';' || arrayText.substr(arrayText.length -1) == ' ' || arrayText == "") {
                    document.getElementById("array").className = 'form-control is-invalid';
                } else {
                    document.getElementById("array").className = 'form-control is-valid';
                };
            });

            document.getElementById("m").addEventListener('change', function() {
                if (document.getElementById("m").value != '' && isNaN(document.getElementById("m").value) == false) {
                    document.getElementById("m").className = 'form-control is-valid';
                } else {
                    document.getElementById("m").className = 'form-control is-invalid';
                };
            });

            setInterval(function(){
                if (document.getElementById("result").innerText == 'NaN') {
                    document.getElementById("result").style.color = '#e74c3c';
                } else {
                    document.getElementById("result").style.color = '#212529';
                };
            }, 100);
        </script>
    </body>
</html>